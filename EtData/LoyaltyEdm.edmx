<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx Version="3.0" xmlns:edmx="http://schemas.microsoft.com/ado/2009/11/edmx">
  <!-- EF Runtime content -->
  <edmx:Runtime>
    <!-- SSDL content -->
    <edmx:StorageModels>
    <Schema Namespace="Хранилище LoyaltyModel" Provider="System.Data.SqlClient" ProviderManifestToken="2012" Alias="Self" xmlns:store="http://schemas.microsoft.com/ado/2007/12/edm/EntityStoreSchemaGenerator" xmlns:customannotation="http://schemas.microsoft.com/ado/2013/11/edm/customannotation" xmlns="http://schemas.microsoft.com/ado/2009/11/edm/ssdl">
        <EntityType Name="campaign_articul">
          <Key>
            <PropertyRef Name="id" />
          </Key>
          <Property Name="id" Type="int" StoreGeneratedPattern="Identity" Nullable="false" />
          <Property Name="campaign_id" Type="bigint" />
          <Property Name="articul" Type="nvarchar" MaxLength="50" />
          <Property Name="market_id" Type="int" />
          <Property Name="name" Type="nvarchar" MaxLength="4000" />
          <Property Name="brand" Type="nvarchar" MaxLength="255" />
          <Property Name="buy_price" Type="numeric" Precision="9" Scale="2" />
          <Property Name="price_shelf_nds" Type="numeric" Precision="9" Scale="2" />
          <Property Name="margin_current" Type="numeric" Precision="9" Scale="2" />
          <Property Name="name_tc" Type="nvarchar" MaxLength="255" />
          <Property Name="rest" Type="int" />
          <Property Name="postv" Type="nvarchar" MaxLength="50" />
          <Property Name="allowed_discount" Type="nchar" MaxLength="10" />
          <Property Name="price_nds_after" Type="numeric" Precision="9" Scale="2" />
          <Property Name="points" Type="int" />
          <Property Name="margin_action" Type="numeric" Precision="9" Scale="2" />
        </EntityType>
        <EntityType Name="campaign_groups">
          <Key>
            <PropertyRef Name="id" />
          </Key>
          <Property Name="id" Type="bigint" StoreGeneratedPattern="Identity" Nullable="false" />
          <Property Name="campaign_id" Type="bigint" />
          <Property Name="group_id" Type="bigint" />
          <Property Name="group_name" Type="nvarchar" MaxLength="255" />
        </EntityType>
        <EntityType Name="campaign_participant">
          <Key>
            <PropertyRef Name="id" />
          </Key>
          <Property Name="id" Type="bigint" StoreGeneratedPattern="Identity" Nullable="false" />
          <Property Name="campaign_id" Type="bigint" />
          <Property Name="card_id" Type="bigint" />
          <Property Name="crm_customer_id" Type="bigint" />
          <Property Name="created" Type="datetime" Nullable="false" />
          <Property Name="delivery_channel" Type="nvarchar" MaxLength="50" />
          <Property Name="control_group" Type="bit" />
          <Property Name="market_id" Type="bigint" />
          <Property Name="free" Type="nvarchar" MaxLength="50" />
        </EntityType>
        <EntityType Name="campaign_sub_groups">
          <Key>
            <PropertyRef Name="id" />
          </Key>
          <Property Name="id" Type="bigint" StoreGeneratedPattern="Identity" Nullable="false" />
          <Property Name="campaign_id" Type="bigint" />
          <Property Name="group_id" Type="bigint" />
          <Property Name="group_name" Type="nvarchar" MaxLength="255" />
        </EntityType>
        <EntityType Name="campaign_types">
          <Key>
            <PropertyRef Name="id" />
          </Key>
          <Property Name="id" Type="bigint" StoreGeneratedPattern="Identity" Nullable="false" />
          <Property Name="name" Type="nvarchar" MaxLength="50" />
        </EntityType>
        <EntityType Name="campaigns_mk">
          <Key>
            <PropertyRef Name="id" />
          </Key>
          <Property Name="id" Type="bigint" StoreGeneratedPattern="Identity" Nullable="false" />
          <Property Name="name" Type="nvarchar" MaxLength="255" />
          <Property Name="date_start" Type="date" />
          <Property Name="date_end" Type="date" />
          <Property Name="created" Type="datetime" />
          <Property Name="is_run" Type="bit" Nullable="false" />
          <Property Name="type_id" Type="bigint" />
          <Property Name="margin_markets" Type="decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_0" Type="decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_1" Type="decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_2" Type="decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_3" Type="decimal" Precision="18" Scale="3" />
          <Property Name="group_id_0" Type="bigint" />
          <Property Name="group_id_1" Type="bigint" />
          <Property Name="markmo_id" Type="bigint" />
        </EntityType>
        <EntityType Name="campaigns_terms">
          <Key>
            <PropertyRef Name="campaigns_terms_id" />
          </Key>
          <Property Name="campaigns_terms_id" Type="bigint" StoreGeneratedPattern="Identity" Nullable="false" />
          <Property Name="campaign_id" Type="bigint" />
          <Property Name="created" Type="datetime" Nullable="false" />
          <Property Name="short_comment" Type="nvarchar" MaxLength="800" />
          <Property Name="description" Type="nvarchar(max)" />
          <Property Name="Rn" Type="int" />
        </EntityType>
        <!--Ошибки, обнаруженные при создании:
предупреждение 6002: В таблице или представлении "crm_wizard.dbo.dict_markets" не определен первичный ключ. Ключ был выведен, а определение таблицы или представления было создано в режиме только для чтения.-->
        <EntityType Name="dict_markets">
          <Key>
            <PropertyRef Name="id" />
          </Key>
          <Property Name="id" Type="int" Nullable="false" />
          <Property Name="short_name" Type="nvarchar" MaxLength="50" />
          <Property Name="name" Type="nvarchar" MaxLength="50" />
          <Property Name="market_name" Type="nvarchar" MaxLength="4000" StoreGeneratedPattern="Computed" />
          <Property Name="is_start" Type="bit" />
          <Property Name="date_start" Type="date" />
        </EntityType>
        <EntityType Name="markmo_types">
          <Key>
            <PropertyRef Name="markmo_type_id" />
          </Key>
          <Property Name="markmo_type_id" Type="int" Nullable="false" />
          <Property Name="title" Type="varchar" MaxLength="100" />
          <Property Name="is_card_binding_obligatory" Type="int" />
        </EntityType>
        <EntityType Name="markmos1">
          <Key>
            <PropertyRef Name="markmo_id" />
          </Key>
          <Property Name="markmo_id" Type="bigint" Nullable="false" />
          <Property Name="start_date" Type="smalldatetime" />
          <Property Name="end_date" Type="smalldatetime" />
          <Property Name="market_id" Type="int" />
          <Property Name="markets" Type="varchar" MaxLength="3000" />
          <Property Name="markmo_type_id" Type="bigint" Nullable="false" />
          <Property Name="description" Type="varchar" MaxLength="4000" />
          <Property Name="value" Type="decimal" Precision="10" Scale="4" Nullable="false" />
          <Property Name="msg_check" Type="varchar" MaxLength="100" />
          <Property Name="msg_gift" Type="varchar" MaxLength="100" />
          <Property Name="value_max" Type="decimal" Precision="10" Scale="4" />
          <Property Name="msg_serv" Type="varchar" MaxLength="255" />
          <Property Name="min_margin" Type="decimal" Precision="12" Scale="2" />
          <Property Name="check_min_margin" Type="bit" Nullable="false" />
          <Property Name="by_request" Type="bit" />
          <Property Name="web_title" Type="varchar" MaxLength="120" />
          <Property Name="web_short_description" Type="varchar" MaxLength="220" />
          <Property Name="distinct_cnt" Type="int" />
          <Property Name="max_amount" Type="decimal" Precision="14" Scale="2" />
        </EntityType>
        <!--Ошибки, обнаруженные при создании:
предупреждение 6002: В таблице или представлении "crm_wizard.calc.v_campaigns_mk" не определен первичный ключ. Ключ был выведен, а определение таблицы или представления было создано в режиме только для чтения.-->
        <EntityType Name="v_campaigns_mk">
          <Key>
            <PropertyRef Name="id" />
            <PropertyRef Name="is_run" />
          </Key>
          <Property Name="id" Type="bigint" StoreGeneratedPattern="Identity" Nullable="false" />
          <Property Name="name" Type="nvarchar" MaxLength="255" />
          <Property Name="date_start" Type="date" />
          <Property Name="date_end" Type="date" />
          <Property Name="created" Type="datetime" />
          <Property Name="is_run" Type="bit" Nullable="false" />
          <Property Name="type_id" Type="bigint" />
          <Property Name="margin_markets" Type="decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_0" Type="decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_1" Type="decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_2" Type="decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_3" Type="decimal" Precision="18" Scale="3" />
          <Property Name="group_id_0" Type="bigint" />
          <Property Name="group_id_1" Type="bigint" />
          <Property Name="markmo_id" Type="bigint" />
          <Property Name="number" Type="bigint" />
        </EntityType>
        <!--Ошибки, обнаруженные при создании:
предупреждение 6002: В таблице или представлении "crm_wizard.calc.v_campaigns_mk_run" не определен первичный ключ. Ключ был выведен, а определение таблицы или представления было создано в режиме только для чтения.-->
        <EntityType Name="v_campaigns_mk_run">
          <Key>
            <PropertyRef Name="id" />
            <PropertyRef Name="is_run" />
          </Key>
          <Property Name="id" Type="bigint" StoreGeneratedPattern="Identity" Nullable="false" />
          <Property Name="name" Type="nvarchar" MaxLength="255" />
          <Property Name="date_start" Type="date" />
          <Property Name="date_end" Type="date" />
          <Property Name="created" Type="datetime" />
          <Property Name="is_run" Type="bit" Nullable="false" />
          <Property Name="type_id" Type="bigint" />
          <Property Name="margin_markets" Type="decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_0" Type="decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_1" Type="decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_2" Type="decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_3" Type="decimal" Precision="18" Scale="3" />
          <Property Name="group_id_0" Type="bigint" />
          <Property Name="group_id_1" Type="bigint" />
          <Property Name="markmo_id" Type="bigint" />
        </EntityType>
        <!--Ошибки, обнаруженные при создании:
предупреждение 6002: В таблице или представлении "crm_wizard.calc.v_fgroups" не определен первичный ключ. Ключ был выведен, а определение таблицы или представления было создано в режиме только для чтения.-->
        <EntityType Name="v_fgroups">
          <Key>
            <PropertyRef Name="fgroup_id" />
            <PropertyRef Name="name" />
            <PropertyRef Name="comments" />
            <PropertyRef Name="parent_id" />
            <PropertyRef Name="level_id" />
            <PropertyRef Name="department_id" />
            <PropertyRef Name="deleted" />
            <PropertyRef Name="is_unload" />
            <PropertyRef Name="pperson_id" />
            <PropertyRef Name="name_ru" />
            <PropertyRef Name="clear_forbidden" />
            <PropertyRef Name="mt_months" />
            <PropertyRef Name="is_virtual" />
            <PropertyRef Name="vdepartment_id" />
          </Key>
          <Property Name="fgroup_id" Type="bigint" Nullable="false" />
          <Property Name="name" Type="varchar" MaxLength="150" Nullable="false" />
          <Property Name="comments" Type="varchar" MaxLength="150" Nullable="false" />
          <Property Name="parent_id" Type="bigint" Nullable="false" />
          <Property Name="level_id" Type="int" Nullable="false" />
          <Property Name="author_id" Type="bigint" />
          <Property Name="department_id" Type="bigint" Nullable="false" />
          <Property Name="deleted" Type="bigint" Nullable="false" />
          <Property Name="is_unload" Type="bigint" Nullable="false" />
          <Property Name="pperson_id" Type="bigint" Nullable="false" />
          <Property Name="name_ru" Type="varchar" MaxLength="200" Nullable="false" />
          <Property Name="clear_forbidden" Type="bit" Nullable="false" />
          <Property Name="mt_months" Type="tinyint" Nullable="false" />
          <Property Name="is_virtual" Type="bit" Nullable="false" />
          <Property Name="vdepartment_id" Type="bigint" Nullable="false" />
        </EntityType>
        <Association Name="FK_campaign_articul_campaigns_mk">
          <End Role="campaigns_mk" Type="Self.campaigns_mk" Multiplicity="0..1" />
          <End Role="campaign_articul" Type="Self.campaign_articul" Multiplicity="*" />
          <ReferentialConstraint>
            <Principal Role="campaigns_mk">
              <PropertyRef Name="id" />
            </Principal>
            <Dependent Role="campaign_articul">
              <PropertyRef Name="campaign_id" />
            </Dependent>
          </ReferentialConstraint>
        </Association>
        <Association Name="FK_campaign_groups_campaigns_mk">
          <End Role="campaigns_mk" Type="Self.campaigns_mk" Multiplicity="0..1" />
          <End Role="campaign_groups" Type="Self.campaign_groups" Multiplicity="*" />
          <ReferentialConstraint>
            <Principal Role="campaigns_mk">
              <PropertyRef Name="id" />
            </Principal>
            <Dependent Role="campaign_groups">
              <PropertyRef Name="campaign_id" />
            </Dependent>
          </ReferentialConstraint>
        </Association>
        <Association Name="FK_campaign_groups_sub_campaigns_mk">
          <End Role="campaigns_mk" Type="Self.campaigns_mk" Multiplicity="0..1" />
          <End Role="campaign_sub_groups" Type="Self.campaign_sub_groups" Multiplicity="*" />
          <ReferentialConstraint>
            <Principal Role="campaigns_mk">
              <PropertyRef Name="id" />
            </Principal>
            <Dependent Role="campaign_sub_groups">
              <PropertyRef Name="campaign_id" />
            </Dependent>
          </ReferentialConstraint>
        </Association>
        <Association Name="FK_campaigns_mk_campaign_types">
          <End Role="campaign_types" Type="Self.campaign_types" Multiplicity="0..1" />
          <End Role="campaigns_mk" Type="Self.campaigns_mk" Multiplicity="*" />
          <ReferentialConstraint>
            <Principal Role="campaign_types">
              <PropertyRef Name="id" />
            </Principal>
            <Dependent Role="campaigns_mk">
              <PropertyRef Name="type_id" />
            </Dependent>
          </ReferentialConstraint>
        </Association>
        <Association Name="FK_participant_campaign_campaigns_mk">
          <End Role="campaigns_mk" Type="Self.campaigns_mk" Multiplicity="0..1" />
          <End Role="campaign_participant" Type="Self.campaign_participant" Multiplicity="*" />
          <ReferentialConstraint>
            <Principal Role="campaigns_mk">
              <PropertyRef Name="id" />
            </Principal>
            <Dependent Role="campaign_participant">
              <PropertyRef Name="campaign_id" />
            </Dependent>
          </ReferentialConstraint>
        </Association>
        <Function Name="t_get_campaign_customers" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="true" ParameterTypeSemantics="AllowImplicitConversion" Schema="calc">
          <Parameter Name="campaign_id" Type="bigint" Mode="In" />
          <ReturnType>
            <CollectionType>
              <RowType>
                <Property Name="number" Type="bigint" />
                <Property Name="name1" Type="nvarchar" MaxLength="50" />
                <Property Name="name2" Type="nvarchar" MaxLength="50" />
                <Property Name="name3" Type="nvarchar" MaxLength="50" />
                <Property Name="gender" Type="nvarchar" MaxLength="10" />
                <Property Name="barcode" Type="nvarchar" MaxLength="50" />
                <Property Name="mobile_phone" Type="nvarchar" MaxLength="50" />
                <Property Name="control_group" Type="nvarchar" MaxLength="50" />
                <Property Name="delivery_channel" Type="nvarchar" MaxLength="50" />
                <Property Name="market_name" Type="nvarchar" MaxLength="50" />
                <Property Name="free" Type="nvarchar" MaxLength="50" />
                <Property Name="crm_customer_id" Type="bigint" />
                <Property Name="is_not_send" Type="bit" />
              </RowType>
            </CollectionType>
          </ReturnType>
        </Function>
        <Function Name="t_get_campaigns" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="true" ParameterTypeSemantics="AllowImplicitConversion" Schema="calc">
          <Parameter Name="isRun" Type="bit" Mode="In" />
          <ReturnType>
            <CollectionType>
              <RowType>
                <Property Name="id" Type="bigint" Nullable="false" />
                <Property Name="name" Type="nvarchar" MaxLength="255" />
                <Property Name="date_start" Type="date" />
                <Property Name="date_end" Type="date" />
                <Property Name="created" Type="datetime" />
                <Property Name="is_run" Type="bit" Nullable="false" />
                <Property Name="type_id" Type="bigint" />
                <Property Name="margin_markets" Type="decimal" Precision="18" Scale="3" />
                <Property Name="margin_lavel_0" Type="decimal" Precision="18" Scale="3" />
                <Property Name="margin_lavel_1" Type="decimal" Precision="18" Scale="3" />
                <Property Name="margin_lavel_2" Type="decimal" Precision="18" Scale="3" />
                <Property Name="margin_lavel_3" Type="decimal" Precision="18" Scale="3" />
                <Property Name="group_id_0" Type="bigint" />
                <Property Name="group_id_1" Type="bigint" />
                <Property Name="markmo_id" Type="bigint" />
                <Property Name="number" Type="bigint" />
                <Property Name="customers_qty" Type="int" />
                <Property Name="customers_qty_control" Type="int" />
                <Property Name="max_term_date" Type="datetime" />
              </RowType>
            </CollectionType>
          </ReturnType>
        </Function>
        <Function Name="p_get_daily_upload_control" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="rep">
          <Parameter Name="date" Type="date" Mode="In" />
          <Parameter Name="market_id" Type="int" Mode="In" />
        </Function>
        <Function Name="p_get_trade_with_extra_points" Aggregate="false" BuiltIn="false" NiladicFunction="false" IsComposable="false" ParameterTypeSemantics="AllowImplicitConversion" Schema="rep">
          <Parameter Name="campaign_id" Type="int" Mode="In" />
          <Parameter Name="date" Type="date" Mode="In" />
          <Parameter Name="market_id" Type="int" Mode="In" />
        </Function>
        <EntityContainer Name="Хранилище LoyaltyModelContainer">
          <EntitySet Name="campaign_articul" EntityType="Self.campaign_articul" Schema="calc" store:Type="Tables" />
          <EntitySet Name="campaign_groups" EntityType="Self.campaign_groups" Schema="calc" store:Type="Tables" />
          <EntitySet Name="campaign_participant" EntityType="Self.campaign_participant" Schema="calc" store:Type="Tables" />
          <EntitySet Name="campaign_sub_groups" EntityType="Self.campaign_sub_groups" Schema="calc" store:Type="Tables" />
          <EntitySet Name="campaign_types" EntityType="Self.campaign_types" Schema="calc" store:Type="Tables" />
          <EntitySet Name="campaigns_mk" EntityType="Self.campaigns_mk" Schema="calc" store:Type="Tables" />
          <EntitySet Name="campaigns_terms" EntityType="Self.campaigns_terms" Schema="calc" store:Type="Tables" />
          <EntitySet Name="markmo_types" EntityType="Self.markmo_types" Schema="dbo" store:Type="Tables" />
          <EntitySet Name="markmos1" EntityType="Self.markmos1" Schema="dbo" store:Type="Tables" />
          <EntitySet Name="dict_markets" EntityType="Self.dict_markets" store:Type="Tables" store:Schema="dbo">
            <DefiningQuery>SELECT 
    [dict_markets].[id] AS [id], 
    [dict_markets].[short_name] AS [short_name], 
    [dict_markets].[name] AS [name], 
    [dict_markets].[market_name] AS [market_name], 
    [dict_markets].[is_start] AS [is_start], 
    [dict_markets].[date_start] AS [date_start]
    FROM [dbo].[dict_markets] AS [dict_markets]</DefiningQuery>
          </EntitySet>
          <EntitySet Name="v_campaigns_mk" EntityType="Self.v_campaigns_mk" store:Type="Views" store:Schema="calc">
            <DefiningQuery>SELECT 
    [v_campaigns_mk].[id] AS [id], 
    [v_campaigns_mk].[name] AS [name], 
    [v_campaigns_mk].[date_start] AS [date_start], 
    [v_campaigns_mk].[date_end] AS [date_end], 
    [v_campaigns_mk].[created] AS [created], 
    [v_campaigns_mk].[is_run] AS [is_run], 
    [v_campaigns_mk].[type_id] AS [type_id], 
    [v_campaigns_mk].[margin_markets] AS [margin_markets], 
    [v_campaigns_mk].[margin_lavel_0] AS [margin_lavel_0], 
    [v_campaigns_mk].[margin_lavel_1] AS [margin_lavel_1], 
    [v_campaigns_mk].[margin_lavel_2] AS [margin_lavel_2], 
    [v_campaigns_mk].[margin_lavel_3] AS [margin_lavel_3], 
    [v_campaigns_mk].[group_id_0] AS [group_id_0], 
    [v_campaigns_mk].[group_id_1] AS [group_id_1], 
    [v_campaigns_mk].[markmo_id] AS [markmo_id], 
    [v_campaigns_mk].[number] AS [number]
    FROM [calc].[v_campaigns_mk] AS [v_campaigns_mk]</DefiningQuery>
          </EntitySet>
          <EntitySet Name="v_campaigns_mk_run" EntityType="Self.v_campaigns_mk_run" store:Type="Views" store:Schema="calc">
            <DefiningQuery>SELECT 
    [v_campaigns_mk_run].[id] AS [id], 
    [v_campaigns_mk_run].[name] AS [name], 
    [v_campaigns_mk_run].[date_start] AS [date_start], 
    [v_campaigns_mk_run].[date_end] AS [date_end], 
    [v_campaigns_mk_run].[created] AS [created], 
    [v_campaigns_mk_run].[is_run] AS [is_run], 
    [v_campaigns_mk_run].[type_id] AS [type_id], 
    [v_campaigns_mk_run].[margin_markets] AS [margin_markets], 
    [v_campaigns_mk_run].[margin_lavel_0] AS [margin_lavel_0], 
    [v_campaigns_mk_run].[margin_lavel_1] AS [margin_lavel_1], 
    [v_campaigns_mk_run].[margin_lavel_2] AS [margin_lavel_2], 
    [v_campaigns_mk_run].[margin_lavel_3] AS [margin_lavel_3], 
    [v_campaigns_mk_run].[group_id_0] AS [group_id_0], 
    [v_campaigns_mk_run].[group_id_1] AS [group_id_1], 
    [v_campaigns_mk_run].[markmo_id] AS [markmo_id]
    FROM [calc].[v_campaigns_mk_run] AS [v_campaigns_mk_run]</DefiningQuery>
          </EntitySet>
          <EntitySet Name="v_fgroups" EntityType="Self.v_fgroups" store:Type="Views" store:Schema="calc">
            <DefiningQuery>SELECT 
    [v_fgroups].[fgroup_id] AS [fgroup_id], 
    [v_fgroups].[name] AS [name], 
    [v_fgroups].[comments] AS [comments], 
    [v_fgroups].[parent_id] AS [parent_id], 
    [v_fgroups].[level_id] AS [level_id], 
    [v_fgroups].[author_id] AS [author_id], 
    [v_fgroups].[department_id] AS [department_id], 
    [v_fgroups].[deleted] AS [deleted], 
    [v_fgroups].[is_unload] AS [is_unload], 
    [v_fgroups].[pperson_id] AS [pperson_id], 
    [v_fgroups].[name_ru] AS [name_ru], 
    [v_fgroups].[clear_forbidden] AS [clear_forbidden], 
    [v_fgroups].[mt_months] AS [mt_months], 
    [v_fgroups].[is_virtual] AS [is_virtual], 
    [v_fgroups].[vdepartment_id] AS [vdepartment_id]
    FROM [calc].[v_fgroups] AS [v_fgroups]</DefiningQuery>
          </EntitySet>
          <AssociationSet Name="FK_campaign_articul_campaigns_mk" Association="Self.FK_campaign_articul_campaigns_mk">
            <End Role="campaigns_mk" EntitySet="campaigns_mk" />
            <End Role="campaign_articul" EntitySet="campaign_articul" />
          </AssociationSet>
          <AssociationSet Name="FK_campaign_groups_campaigns_mk" Association="Self.FK_campaign_groups_campaigns_mk">
            <End Role="campaigns_mk" EntitySet="campaigns_mk" />
            <End Role="campaign_groups" EntitySet="campaign_groups" />
          </AssociationSet>
          <AssociationSet Name="FK_campaign_groups_sub_campaigns_mk" Association="Self.FK_campaign_groups_sub_campaigns_mk">
            <End Role="campaigns_mk" EntitySet="campaigns_mk" />
            <End Role="campaign_sub_groups" EntitySet="campaign_sub_groups" />
          </AssociationSet>
          <AssociationSet Name="FK_campaigns_mk_campaign_types" Association="Self.FK_campaigns_mk_campaign_types">
            <End Role="campaign_types" EntitySet="campaign_types" />
            <End Role="campaigns_mk" EntitySet="campaigns_mk" />
          </AssociationSet>
          <AssociationSet Name="FK_participant_campaign_campaigns_mk" Association="Self.FK_participant_campaign_campaigns_mk">
            <End Role="campaigns_mk" EntitySet="campaigns_mk" />
            <End Role="campaign_participant" EntitySet="campaign_participant" />
          </AssociationSet>
        </EntityContainer>
      </Schema></edmx:StorageModels>
    <!-- CSDL content -->
    <edmx:ConceptualModels>
      <Schema Namespace="LoyaltyModel" Alias="Self" annotation:UseStrongSpatialTypes="false" xmlns:annotation="http://schemas.microsoft.com/ado/2009/02/edm/annotation" xmlns:customannotation="http://schemas.microsoft.com/ado/2013/11/edm/customannotation" xmlns="http://schemas.microsoft.com/ado/2009/11/edm">
        <EntityContainer Name="LoyaltyEntities" annotation:LazyLoadingEnabled="true">
          <FunctionImport Name="p_get_trade_with_extra_points" ReturnType="Collection(LoyaltyModel.p_get_trade_with_extra_points_Result)">
            <Parameter Name="campaign_id" Mode="In" Type="Int32" />
            <Parameter Name="date" Mode="In" Type="DateTime" />
            <Parameter Name="market_id" Mode="In" Type="Int32" />
          </FunctionImport>
          <FunctionImport Name="p_get_daily_upload_control" ReturnType="Collection(LoyaltyModel.UPLOAD_CONTROL)">
            <Parameter Name="date" Mode="In" Type="DateTime" />
            <Parameter Name="market_id" Mode="In" Type="Int32" />
          </FunctionImport>
          <FunctionImport Name="t_get_campaign_customers" IsComposable="true" ReturnType="Collection(LoyaltyModel.tf_campaign_customers)">
          <Parameter Name="campaign_id" Mode="In" Type="Int64" />
          </FunctionImport>
          <EntitySet Name="campaign_articul" EntityType="LoyaltyModel.campaign_articul" />
          <EntitySet Name="campaign_groups" EntityType="LoyaltyModel.campaign_groups" />
          <EntitySet Name="campaign_participant" EntityType="LoyaltyModel.campaign_participant" />
          <EntitySet Name="campaign_sub_groups" EntityType="LoyaltyModel.campaign_sub_groups" />
          <EntitySet Name="campaign_types" EntityType="LoyaltyModel.campaign_types" />
          <EntitySet Name="campaigns_mk" EntityType="LoyaltyModel.campaigns_mk" />
          <EntitySet Name="markmo_types" EntityType="LoyaltyModel.markmo_types" />
          <EntitySet Name="markmos1" EntityType="LoyaltyModel.markmos1" />
          <EntitySet Name="v_campaigns_mk" EntityType="LoyaltyModel.v_campaigns_mk" />
          <EntitySet Name="v_campaigns_mk_run" EntityType="LoyaltyModel.v_campaigns_mk_run" />
          <EntitySet Name="v_fgroups" EntityType="LoyaltyModel.v_fgroups" />
          <AssociationSet Name="FK_campaign_articul_campaigns_mk" Association="LoyaltyModel.FK_campaign_articul_campaigns_mk">
            <End Role="campaigns_mk" EntitySet="campaigns_mk" />
            <End Role="campaign_articul" EntitySet="campaign_articul" />
          </AssociationSet>
          <AssociationSet Name="FK_campaign_groups_campaigns_mk" Association="LoyaltyModel.FK_campaign_groups_campaigns_mk">
            <End Role="campaigns_mk" EntitySet="campaigns_mk" />
            <End Role="campaign_groups" EntitySet="campaign_groups" />
          </AssociationSet>
          <AssociationSet Name="FK_participant_campaign_campaigns_mk" Association="LoyaltyModel.FK_participant_campaign_campaigns_mk">
            <End Role="campaigns_mk" EntitySet="campaigns_mk" />
            <End Role="campaign_participant" EntitySet="campaign_participant" />
          </AssociationSet>
          <AssociationSet Name="FK_campaign_groups_sub_campaigns_mk" Association="LoyaltyModel.FK_campaign_groups_sub_campaigns_mk">
            <End Role="campaigns_mk" EntitySet="campaigns_mk" />
            <End Role="campaign_sub_groups" EntitySet="campaign_sub_groups" />
          </AssociationSet>
          <AssociationSet Name="FK_campaigns_mk_campaign_types" Association="LoyaltyModel.FK_campaigns_mk_campaign_types">
            <End Role="campaign_types" EntitySet="campaign_types" />
            <End Role="campaigns_mk" EntitySet="campaigns_mk" />
          </AssociationSet>
          <EntitySet Name="campaigns_terms" EntityType="LoyaltyModel.campaigns_terms" />
          <FunctionImport Name="t_get_campaigns" IsComposable="true" ReturnType="Collection(LoyaltyModel.tf_campaigns)">
          <Parameter Name="isRun" Mode="In" Type="Boolean" />
          </FunctionImport>
          <EntitySet Name="dict_markets" EntityType="LoyaltyModel.dict_markets" />
        </EntityContainer>
        <ComplexType Name="p_get_trade_with_extra_points_Result">
          <Property Type="String" Name="articul" Nullable="true" MaxLength="255" />
          <Property Type="String" Name="name" Nullable="true" MaxLength="255" />
          <Property Type="Decimal" Name="trade_qty_participant" Nullable="true" Precision="38" Scale="2" />
          <Property Type="Decimal" Name="sm_participant" Nullable="true" Precision="38" Scale="2" />
          <Property Type="Decimal" Name="trade_qty_all" Nullable="true" Precision="38" Scale="2" />
          <Property Type="Decimal" Name="sm_all" Nullable="true" Precision="38" Scale="2" />
        </ComplexType>
        <ComplexType Name="UPLOAD_CONTROL">
          <Property Type="String" Name="city" Nullable="true" MaxLength="50" />
          <Property Type="Decimal" Name="customers_qty" Nullable="true" Precision="18" Scale="2" />
          <Property Type="Decimal" Name="diff_customers_qty" Nullable="true" Precision="19" Scale="2" />
          <Property Type="Int32" Name="is_alert_customers_qty" Nullable="false" />
          <Property Type="Decimal" Name="card_issued_qty" Nullable="true" Precision="18" Scale="2" />
          <Property Type="Decimal" Name="diff_card_issued_qty" Nullable="true" Precision="19" Scale="2" />
          <Property Type="Int32" Name="is_alert_card_issued_qty" Nullable="false" />
          <Property Type="Decimal" Name="knk_qty" Nullable="true" Precision="18" Scale="2" />
          <Property Type="Decimal" Name="diff_knk_qty" Nullable="true" Precision="19" Scale="2" />
          <Property Type="Int32" Name="is_alert_knk_qty" Nullable="false" />
          <Property Type="Decimal" Name="qty_doc" Nullable="true" Precision="18" Scale="2" />
          <Property Type="Decimal" Name="diff_qty_doc" Nullable="true" Precision="19" Scale="2" />
          <Property Type="Int32" Name="is_alert_qty_doc" Nullable="false" />
          <Property Type="Decimal" Name="rrz_qty" Nullable="true" Precision="18" Scale="2" />
          <Property Type="Decimal" Name="diff_rrz_qty" Nullable="true" Precision="19" Scale="2" />
          <Property Type="Int32" Name="is_alert_rrz_qty" Nullable="false" />
          <Property Type="Decimal" Name="qty_sell_record_qty" Nullable="true" Precision="18" Scale="2" />
          <Property Type="Decimal" Name="diff_qty_sell_record_qty" Nullable="true" Precision="19" Scale="2" />
          <Property Type="Int32" Name="is_alert_qty_sell_record_qty" Nullable="false" />
        </ComplexType>
        <ComplexType Name="tf_campaign_customers">
          <Property Type="Int64" Name="number" Nullable="true" />
          <Property Type="String" Name="name1" Nullable="true" MaxLength="50" />
          <Property Type="String" Name="name2" Nullable="true" MaxLength="50" />
          <Property Type="String" Name="name3" Nullable="true" MaxLength="50" />
          <Property Type="String" Name="gender" Nullable="false" MaxLength="3" />
          <Property Type="String" Name="barcode" Nullable="false" MaxLength="13" />
          <Property Type="String" Name="mobile_phone" Nullable="true" MaxLength="30" />
          <Property Type="String" Name="control_group" Nullable="true" MaxLength="3" />
          <Property Type="String" Name="delivery_channel" Nullable="true" MaxLength="50" />
          <Property Type="String" Name="market_name" Nullable="true" MaxLength="4000" />
        </ComplexType>
        <EntityType Name="campaign_articul">
          <Key>
            <PropertyRef Name="id" />
          </Key>
          <Property Name="id" Type="Int32" Nullable="false" annotation:StoreGeneratedPattern="Identity" />
          <Property Name="campaign_id" Type="Int64" />
          <Property Name="articul" Type="String" MaxLength="50" FixedLength="false" Unicode="true" />
          <Property Name="market_id" Type="Int32" />
          <Property Name="name" Type="String" MaxLength="4000" FixedLength="false" Unicode="true" />
          <Property Name="brand" Type="String" MaxLength="255" FixedLength="false" Unicode="true" />
          <Property Name="buy_price" Type="Decimal" Precision="9" Scale="2" />
          <Property Name="price_shelf_nds" Type="Decimal" Precision="9" Scale="2" />
          <Property Name="margin_current" Type="Decimal" Precision="9" Scale="2" />
          <Property Name="name_tc" Type="String" MaxLength="255" FixedLength="false" Unicode="true" />
          <Property Name="rest" Type="Int32" />
          <Property Name="postv" Type="String" MaxLength="50" FixedLength="false" Unicode="true" />
          <Property Name="allowed_discount" Type="String" MaxLength="10" FixedLength="true" Unicode="true" />
          <Property Name="price_nds_after" Type="Decimal" Precision="9" Scale="2" />
          <Property Name="points" Type="Int32" />
          <Property Name="margin_action" Type="Decimal" Precision="9" Scale="2" />
          <NavigationProperty Name="campaigns_mk" Relationship="LoyaltyModel.FK_campaign_articul_campaigns_mk" FromRole="campaign_articul" ToRole="campaigns_mk" />
        </EntityType>
        <EntityType Name="campaign_groups">
          <Key>
            <PropertyRef Name="id" />
          </Key>
          <Property Name="id" Type="Int64" Nullable="false" annotation:StoreGeneratedPattern="Identity" />
          <Property Name="campaign_id" Type="Int64" />
          <Property Name="group_id" Type="Int64" />
          <Property Name="group_name" Type="String" MaxLength="255" FixedLength="false" Unicode="true" />
          <NavigationProperty Name="campaigns_mk" Relationship="LoyaltyModel.FK_campaign_groups_campaigns_mk" FromRole="campaign_groups" ToRole="campaigns_mk" />
        </EntityType>
        <EntityType Name="campaign_participant">
          <Key>
            <PropertyRef Name="id" />
          </Key>
          <Property Name="id" Type="Int64" Nullable="false" annotation:StoreGeneratedPattern="Identity" />
          <Property Name="campaign_id" Type="Int64" />
          <Property Name="card_id" Type="Int64" />
          <Property Name="crm_customer_id" Type="Int64" />
          <Property Name="created" Type="DateTime" Nullable="false" Precision="3" />
          <Property Name="delivery_channel" Type="String" MaxLength="50" FixedLength="false" Unicode="true" />
          <Property Name="control_group" Type="Boolean" />
          <Property Name="market_id" Type="Int64" />
          <NavigationProperty Name="campaigns_mk" Relationship="LoyaltyModel.FK_participant_campaign_campaigns_mk" FromRole="campaign_participant" ToRole="campaigns_mk" />
          <Property Name="free" Type="String" MaxLength="50" FixedLength="false" Unicode="true" />
        </EntityType>
        <EntityType Name="campaign_sub_groups">
          <Key>
            <PropertyRef Name="id" />
          </Key>
          <Property Name="id" Type="Int64" Nullable="false" annotation:StoreGeneratedPattern="Identity" />
          <Property Name="campaign_id" Type="Int64" />
          <Property Name="group_id" Type="Int64" />
          <Property Name="group_name" Type="String" MaxLength="255" FixedLength="false" Unicode="true" />
          <NavigationProperty Name="campaigns_mk" Relationship="LoyaltyModel.FK_campaign_groups_sub_campaigns_mk" FromRole="campaign_sub_groups" ToRole="campaigns_mk" />
        </EntityType>
        <EntityType Name="campaign_types">
          <Key>
            <PropertyRef Name="id" />
          </Key>
          <Property Name="id" Type="Int64" Nullable="false" annotation:StoreGeneratedPattern="Identity" />
          <Property Name="name" Type="String" MaxLength="50" FixedLength="false" Unicode="true" />
          <NavigationProperty Name="campaigns_mk" Relationship="LoyaltyModel.FK_campaigns_mk_campaign_types" FromRole="campaign_types" ToRole="campaigns_mk" />
        </EntityType>
        <EntityType Name="campaigns_mk">
          <Key>
            <PropertyRef Name="id" />
          </Key>
          <Property Name="id" Type="Int64" Nullable="false" annotation:StoreGeneratedPattern="Identity" />
          <Property Name="name" Type="String" MaxLength="255" FixedLength="false" Unicode="true" />
          <Property Name="date_start" Type="DateTime" Precision="0" />
          <Property Name="date_end" Type="DateTime" Precision="0" />
          <Property Name="created" Type="DateTime" Precision="3" />
          <Property Name="is_run" Type="Boolean" Nullable="false" />
          <Property Name="type_id" Type="Int64" />
          <Property Name="margin_markets" Type="Decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_0" Type="Decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_1" Type="Decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_2" Type="Decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_3" Type="Decimal" Precision="18" Scale="3" />
          <Property Name="group_id_0" Type="Int64" />
          <Property Name="group_id_1" Type="Int64" />
          <Property Name="markmo_id" Type="Int64" />
          <NavigationProperty Name="campaign_articul" Relationship="LoyaltyModel.FK_campaign_articul_campaigns_mk" FromRole="campaigns_mk" ToRole="campaign_articul" />
          <NavigationProperty Name="campaign_groups" Relationship="LoyaltyModel.FK_campaign_groups_campaigns_mk" FromRole="campaigns_mk" ToRole="campaign_groups" />
          <NavigationProperty Name="campaign_participant" Relationship="LoyaltyModel.FK_participant_campaign_campaigns_mk" FromRole="campaigns_mk" ToRole="campaign_participant" />
          <NavigationProperty Name="campaign_sub_groups" Relationship="LoyaltyModel.FK_campaign_groups_sub_campaigns_mk" FromRole="campaigns_mk" ToRole="campaign_sub_groups" />
          <NavigationProperty Name="campaign_types" Relationship="LoyaltyModel.FK_campaigns_mk_campaign_types" FromRole="campaigns_mk" ToRole="campaign_types" />
        </EntityType>
        <EntityType Name="markmo_types">
          <Key>
            <PropertyRef Name="markmo_type_id" />
          </Key>
          <Property Name="markmo_type_id" Type="Int32" Nullable="false" />
          <Property Name="title" Type="String" MaxLength="100" FixedLength="false" Unicode="false" />
          <Property Name="is_card_binding_obligatory" Type="Int32" />
        </EntityType>
        <EntityType Name="markmos1">
          <Key>
            <PropertyRef Name="markmo_id" />
          </Key>
          <Property Name="markmo_id" Type="Int64" Nullable="false" />
          <Property Name="start_date" Type="DateTime" Precision="0" />
          <Property Name="end_date" Type="DateTime" Precision="0" />
          <Property Name="market_id" Type="Int32" />
          <Property Name="markets" Type="String" MaxLength="3000" FixedLength="false" Unicode="false" />
          <Property Name="markmo_type_id" Type="Int64" Nullable="false" />
          <Property Name="description" Type="String" MaxLength="4000" FixedLength="false" Unicode="false" />
          <Property Name="value" Type="Decimal" Nullable="false" Precision="10" Scale="4" />
          <Property Name="msg_check" Type="String" MaxLength="100" FixedLength="false" Unicode="false" />
          <Property Name="msg_gift" Type="String" MaxLength="100" FixedLength="false" Unicode="false" />
          <Property Name="value_max" Type="Decimal" Precision="10" Scale="4" />
          <Property Name="msg_serv" Type="String" MaxLength="255" FixedLength="false" Unicode="false" />
          <Property Name="min_margin" Type="Decimal" Precision="12" Scale="2" />
          <Property Name="check_min_margin" Type="Boolean" Nullable="false" />
          <Property Name="by_request" Type="Boolean" />
          <Property Name="web_title" Type="String" MaxLength="120" FixedLength="false" Unicode="false" />
          <Property Name="web_short_description" Type="String" MaxLength="220" FixedLength="false" Unicode="false" />
          <Property Name="distinct_cnt" Type="Int32" />
          <Property Name="max_amount" Type="Decimal" Precision="14" Scale="2" />
        </EntityType>
        <EntityType Name="v_campaigns_mk">
          <Key>
            <PropertyRef Name="id" />
            <PropertyRef Name="is_run" />
          </Key>
          <Property Name="id" Type="Int64" Nullable="false" annotation:StoreGeneratedPattern="Identity" />
          <Property Name="name" Type="String" MaxLength="255" FixedLength="false" Unicode="true" />
          <Property Name="date_start" Type="DateTime" Precision="0" />
          <Property Name="date_end" Type="DateTime" Precision="0" />
          <Property Name="created" Type="DateTime" Precision="3" />
          <Property Name="is_run" Type="Boolean" Nullable="false" />
          <Property Name="type_id" Type="Int64" />
          <Property Name="margin_markets" Type="Decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_0" Type="Decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_1" Type="Decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_2" Type="Decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_3" Type="Decimal" Precision="18" Scale="3" />
          <Property Name="group_id_0" Type="Int64" />
          <Property Name="group_id_1" Type="Int64" />
          <Property Name="markmo_id" Type="Int64" />
          <Property Name="number" Type="Int64" />
        </EntityType>
        <EntityType Name="v_campaigns_mk_run">
          <Key>
            <PropertyRef Name="id" />
            <PropertyRef Name="is_run" />
          </Key>
          <Property Name="id" Type="Int64" Nullable="false" annotation:StoreGeneratedPattern="Identity" />
          <Property Name="name" Type="String" MaxLength="255" FixedLength="false" Unicode="true" />
          <Property Name="date_start" Type="DateTime" Precision="0" />
          <Property Name="date_end" Type="DateTime" Precision="0" />
          <Property Name="created" Type="DateTime" Precision="3" />
          <Property Name="is_run" Type="Boolean" Nullable="false" />
          <Property Name="type_id" Type="Int64" />
          <Property Name="margin_markets" Type="Decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_0" Type="Decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_1" Type="Decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_2" Type="Decimal" Precision="18" Scale="3" />
          <Property Name="margin_lavel_3" Type="Decimal" Precision="18" Scale="3" />
          <Property Name="group_id_0" Type="Int64" />
          <Property Name="group_id_1" Type="Int64" />
          <Property Name="markmo_id" Type="Int64" />
        </EntityType>
        <EntityType Name="v_fgroups">
          <Key>
            <PropertyRef Name="fgroup_id" />
            <PropertyRef Name="name" />
            <PropertyRef Name="comments" />
            <PropertyRef Name="parent_id" />
            <PropertyRef Name="level_id" />
            <PropertyRef Name="department_id" />
            <PropertyRef Name="deleted" />
            <PropertyRef Name="is_unload" />
            <PropertyRef Name="pperson_id" />
            <PropertyRef Name="name_ru" />
            <PropertyRef Name="clear_forbidden" />
            <PropertyRef Name="mt_months" />
            <PropertyRef Name="is_virtual" />
            <PropertyRef Name="vdepartment_id" />
          </Key>
          <Property Name="fgroup_id" Type="Int64" Nullable="false" />
          <Property Name="name" Type="String" Nullable="false" MaxLength="150" FixedLength="false" Unicode="false" />
          <Property Name="comments" Type="String" Nullable="false" MaxLength="150" FixedLength="false" Unicode="false" />
          <Property Name="parent_id" Type="Int64" Nullable="false" />
          <Property Name="level_id" Type="Int32" Nullable="false" />
          <Property Name="author_id" Type="Int64" />
          <Property Name="department_id" Type="Int64" Nullable="false" />
          <Property Name="deleted" Type="Int64" Nullable="false" />
          <Property Name="is_unload" Type="Int64" Nullable="false" />
          <Property Name="pperson_id" Type="Int64" Nullable="false" />
          <Property Name="name_ru" Type="String" Nullable="false" MaxLength="200" FixedLength="false" Unicode="false" />
          <Property Name="clear_forbidden" Type="Boolean" Nullable="false" />
          <Property Name="mt_months" Type="Byte" Nullable="false" />
          <Property Name="is_virtual" Type="Boolean" Nullable="false" />
          <Property Name="vdepartment_id" Type="Int64" Nullable="false" />
        </EntityType>
        <Association Name="FK_campaign_articul_campaigns_mk">
          <End Type="LoyaltyModel.campaigns_mk" Role="campaigns_mk" Multiplicity="0..1" />
          <End Type="LoyaltyModel.campaign_articul" Role="campaign_articul" Multiplicity="*" />
          <ReferentialConstraint>
            <Principal Role="campaigns_mk">
              <PropertyRef Name="id" />
            </Principal>
            <Dependent Role="campaign_articul">
              <PropertyRef Name="campaign_id" />
            </Dependent>
          </ReferentialConstraint>
        </Association>
        <Association Name="FK_campaign_groups_campaigns_mk">
          <End Type="LoyaltyModel.campaigns_mk" Role="campaigns_mk" Multiplicity="0..1" />
          <End Type="LoyaltyModel.campaign_groups" Role="campaign_groups" Multiplicity="*" />
          <ReferentialConstraint>
            <Principal Role="campaigns_mk">
              <PropertyRef Name="id" />
            </Principal>
            <Dependent Role="campaign_groups">
              <PropertyRef Name="campaign_id" />
            </Dependent>
          </ReferentialConstraint>
        </Association>
        <Association Name="FK_participant_campaign_campaigns_mk">
          <End Type="LoyaltyModel.campaigns_mk" Role="campaigns_mk" Multiplicity="0..1" />
          <End Type="LoyaltyModel.campaign_participant" Role="campaign_participant" Multiplicity="*" />
          <ReferentialConstraint>
            <Principal Role="campaigns_mk">
              <PropertyRef Name="id" />
            </Principal>
            <Dependent Role="campaign_participant">
              <PropertyRef Name="campaign_id" />
            </Dependent>
          </ReferentialConstraint>
        </Association>
        <Association Name="FK_campaign_groups_sub_campaigns_mk">
          <End Type="LoyaltyModel.campaigns_mk" Role="campaigns_mk" Multiplicity="0..1" />
          <End Type="LoyaltyModel.campaign_sub_groups" Role="campaign_sub_groups" Multiplicity="*" />
          <ReferentialConstraint>
            <Principal Role="campaigns_mk">
              <PropertyRef Name="id" />
            </Principal>
            <Dependent Role="campaign_sub_groups">
              <PropertyRef Name="campaign_id" />
            </Dependent>
          </ReferentialConstraint>
        </Association>
        <Association Name="FK_campaigns_mk_campaign_types">
          <End Type="LoyaltyModel.campaign_types" Role="campaign_types" Multiplicity="0..1" />
          <End Type="LoyaltyModel.campaigns_mk" Role="campaigns_mk" Multiplicity="*" />
          <ReferentialConstraint>
            <Principal Role="campaign_types">
              <PropertyRef Name="id" />
            </Principal>
            <Dependent Role="campaigns_mk">
              <PropertyRef Name="type_id" />
            </Dependent>
          </ReferentialConstraint>
        </Association>
        <EntityType Name="campaigns_terms">
          <Key>
            <PropertyRef Name="campaigns_terms_id" />
          </Key>
          <Property Name="campaigns_terms_id" Type="Int64" Nullable="false" annotation:StoreGeneratedPattern="Identity" />
          <Property Name="campaign_id" Type="Int64" />
          <Property Name="created" Type="DateTime" Precision="3" Nullable="false" />
          <Property Name="short_comment" Type="String" MaxLength="800" FixedLength="false" Unicode="true" />
          <Property Name="description" Type="String" MaxLength="Max" FixedLength="false" Unicode="true" />
          <Property Name="Rn" Type="Int32" />
        </EntityType>
        <ComplexType Name="tf_campaigns">
          <Property Type="Int64" Name="id" Nullable="false" />
          <Property Type="String" Name="name" Nullable="true" MaxLength="255" />
          <Property Type="DateTime" Name="date_start" Nullable="true" Precision="10" />
          <Property Type="DateTime" Name="date_end" Nullable="true" Precision="10" />
          <Property Type="DateTime" Name="created" Nullable="true" Precision="23" />
          <Property Type="Boolean" Name="is_run" Nullable="false" />
          <Property Type="Int64" Name="type_id" Nullable="true" />
          <Property Type="Decimal" Name="margin_markets" Nullable="true" Precision="18" Scale="3" />
          <Property Type="Decimal" Name="margin_lavel_0" Nullable="true" Precision="18" Scale="3" />
          <Property Type="Decimal" Name="margin_lavel_1" Nullable="true" Precision="18" Scale="3" />
          <Property Type="Decimal" Name="margin_lavel_2" Nullable="true" Precision="18" Scale="3" />
          <Property Type="Decimal" Name="margin_lavel_3" Nullable="true" Precision="18" Scale="3" />
          <Property Type="Int64" Name="group_id_0" Nullable="true" />
          <Property Type="Int64" Name="group_id_1" Nullable="true" />
          <Property Type="Int64" Name="markmo_id" Nullable="true" />
          <Property Type="Int64" Name="number" Nullable="true" />
          <Property Type="Int32" Name="customers_qty" Nullable="true" />
          <Property Type="Int32" Name="customers_qty_control" Nullable="true" />
          <Property Type="DateTime" Name="max_term_date" Nullable="true" Precision="23" />
        </ComplexType>
        <EntityType Name="dict_markets">
          <Key>
            <PropertyRef Name="id" />
          </Key>
          <Property Name="id" Type="Int32" Nullable="false" />
          <Property Name="short_name" Type="String" MaxLength="50" FixedLength="false" Unicode="true" />
          <Property Name="name" Type="String" MaxLength="50" FixedLength="false" Unicode="true" />
          <Property Name="market_name" Type="String" MaxLength="4000" FixedLength="false" Unicode="true" annotation:StoreGeneratedPattern="Computed" />
          <Property Name="is_start" Type="Boolean" />
          <Property Name="date_start" Type="DateTime" Precision="0" />
        </EntityType>
      </Schema>
    </edmx:ConceptualModels>
    <!-- C-S mapping content -->
    <edmx:Mappings>
      <Mapping Space="C-S" xmlns="http://schemas.microsoft.com/ado/2009/11/mapping/cs">
        <EntityContainerMapping StorageEntityContainer="Хранилище LoyaltyModelContainer" CdmEntityContainer="LoyaltyEntities">
          <FunctionImportMapping FunctionImportName="p_get_trade_with_extra_points" FunctionName="Хранилище LoyaltyModel.p_get_trade_with_extra_points">
            <ResultMapping>
              <ComplexTypeMapping TypeName="LoyaltyModel.p_get_trade_with_extra_points_Result">
                <ScalarProperty Name="articul" ColumnName="articul" />
                <ScalarProperty Name="name" ColumnName="name" />
                <ScalarProperty Name="trade_qty_participant" ColumnName="trade_qty_participant" />
                <ScalarProperty Name="sm_participant" ColumnName="sm_participant" />
                <ScalarProperty Name="trade_qty_all" ColumnName="trade_qty_all" />
                <ScalarProperty Name="sm_all" ColumnName="sm_all" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
          <FunctionImportMapping FunctionImportName="p_get_daily_upload_control" FunctionName="Хранилище LoyaltyModel.p_get_daily_upload_control">
            <ResultMapping>
              <ComplexTypeMapping TypeName="LoyaltyModel.UPLOAD_CONTROL">
                <ScalarProperty Name="city" ColumnName="city" />
                <ScalarProperty Name="customers_qty" ColumnName="customers_qty" />
                <ScalarProperty Name="diff_customers_qty" ColumnName="diff_customers_qty" />
                <ScalarProperty Name="is_alert_customers_qty" ColumnName="is_alert_customers_qty" />
                <ScalarProperty Name="card_issued_qty" ColumnName="card_issued_qty" />
                <ScalarProperty Name="diff_card_issued_qty" ColumnName="diff_card_issued_qty" />
                <ScalarProperty Name="is_alert_card_issued_qty" ColumnName="is_alert_card_issued_qty" />
                <ScalarProperty Name="knk_qty" ColumnName="knk_qty" />
                <ScalarProperty Name="diff_knk_qty" ColumnName="diff_knk_qty" />
                <ScalarProperty Name="is_alert_knk_qty" ColumnName="is_alert_knk_qty" />
                <ScalarProperty Name="qty_doc" ColumnName="qty_doc" />
                <ScalarProperty Name="diff_qty_doc" ColumnName="diff_qty_doc" />
                <ScalarProperty Name="is_alert_qty_doc" ColumnName="is_alert_qty_doc" />
                <ScalarProperty Name="rrz_qty" ColumnName="rrz_qty" />
                <ScalarProperty Name="diff_rrz_qty" ColumnName="diff_rrz_qty" />
                <ScalarProperty Name="is_alert_rrz_qty" ColumnName="is_alert_rrz_qty" />
                <ScalarProperty Name="qty_sell_record_qty" ColumnName="qty_sell_record_qty" />
                <ScalarProperty Name="diff_qty_sell_record_qty" ColumnName="diff_qty_sell_record_qty" />
                <ScalarProperty Name="is_alert_qty_sell_record_qty" ColumnName="is_alert_qty_sell_record_qty" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
          <FunctionImportMapping FunctionImportName="t_get_campaign_customers" FunctionName="Хранилище LoyaltyModel.t_get_campaign_customers">
            <ResultMapping>
              <ComplexTypeMapping TypeName="LoyaltyModel.tf_campaign_customers">
                <ScalarProperty Name="number" ColumnName="number" />
                <ScalarProperty Name="name1" ColumnName="name1" />
                <ScalarProperty Name="name2" ColumnName="name2" />
                <ScalarProperty Name="name3" ColumnName="name3" />
                <ScalarProperty Name="gender" ColumnName="gender" />
                <ScalarProperty Name="barcode" ColumnName="barcode" />
                <ScalarProperty Name="mobile_phone" ColumnName="mobile_phone" />
                <ScalarProperty Name="control_group" ColumnName="control_group" />
                <ScalarProperty Name="delivery_channel" ColumnName="delivery_channel" />
                <ScalarProperty Name="market_name" ColumnName="market_name" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
          <EntitySetMapping Name="campaign_articul">
            <EntityTypeMapping TypeName="LoyaltyModel.campaign_articul">
              <MappingFragment StoreEntitySet="campaign_articul">
                <ScalarProperty Name="margin_action" ColumnName="margin_action" />
                <ScalarProperty Name="points" ColumnName="points" />
                <ScalarProperty Name="price_nds_after" ColumnName="price_nds_after" />
                <ScalarProperty Name="allowed_discount" ColumnName="allowed_discount" />
                <ScalarProperty Name="postv" ColumnName="postv" />
                <ScalarProperty Name="rest" ColumnName="rest" />
                <ScalarProperty Name="name_tc" ColumnName="name_tc" />
                <ScalarProperty Name="margin_current" ColumnName="margin_current" />
                <ScalarProperty Name="price_shelf_nds" ColumnName="price_shelf_nds" />
                <ScalarProperty Name="buy_price" ColumnName="buy_price" />
                <ScalarProperty Name="brand" ColumnName="brand" />
                <ScalarProperty Name="name" ColumnName="name" />
                <ScalarProperty Name="market_id" ColumnName="market_id" />
                <ScalarProperty Name="articul" ColumnName="articul" />
                <ScalarProperty Name="campaign_id" ColumnName="campaign_id" />
                <ScalarProperty Name="id" ColumnName="id" />
              </MappingFragment>
            </EntityTypeMapping>
          </EntitySetMapping>
          <EntitySetMapping Name="campaign_groups">
            <EntityTypeMapping TypeName="LoyaltyModel.campaign_groups">
              <MappingFragment StoreEntitySet="campaign_groups">
                <ScalarProperty Name="group_name" ColumnName="group_name" />
                <ScalarProperty Name="group_id" ColumnName="group_id" />
                <ScalarProperty Name="campaign_id" ColumnName="campaign_id" />
                <ScalarProperty Name="id" ColumnName="id" />
              </MappingFragment>
            </EntityTypeMapping>
          </EntitySetMapping>
          <EntitySetMapping Name="campaign_participant">
            <EntityTypeMapping TypeName="LoyaltyModel.campaign_participant">
              <MappingFragment StoreEntitySet="campaign_participant">
                <ScalarProperty Name="free" ColumnName="free" />
                <ScalarProperty Name="market_id" ColumnName="market_id" />
                <ScalarProperty Name="control_group" ColumnName="control_group" />
                <ScalarProperty Name="delivery_channel" ColumnName="delivery_channel" />
                <ScalarProperty Name="created" ColumnName="created" />
                <ScalarProperty Name="crm_customer_id" ColumnName="crm_customer_id" />
                <ScalarProperty Name="card_id" ColumnName="card_id" />
                <ScalarProperty Name="campaign_id" ColumnName="campaign_id" />
                <ScalarProperty Name="id" ColumnName="id" />
              </MappingFragment>
            </EntityTypeMapping>
          </EntitySetMapping>
          <EntitySetMapping Name="campaign_sub_groups">
            <EntityTypeMapping TypeName="LoyaltyModel.campaign_sub_groups">
              <MappingFragment StoreEntitySet="campaign_sub_groups">
                <ScalarProperty Name="group_name" ColumnName="group_name" />
                <ScalarProperty Name="group_id" ColumnName="group_id" />
                <ScalarProperty Name="campaign_id" ColumnName="campaign_id" />
                <ScalarProperty Name="id" ColumnName="id" />
              </MappingFragment>
            </EntityTypeMapping>
          </EntitySetMapping>
          <EntitySetMapping Name="campaign_types">
            <EntityTypeMapping TypeName="LoyaltyModel.campaign_types">
              <MappingFragment StoreEntitySet="campaign_types">
                <ScalarProperty Name="name" ColumnName="name" />
                <ScalarProperty Name="id" ColumnName="id" />
              </MappingFragment>
            </EntityTypeMapping>
          </EntitySetMapping>
          <EntitySetMapping Name="campaigns_mk">
            <EntityTypeMapping TypeName="LoyaltyModel.campaigns_mk">
              <MappingFragment StoreEntitySet="campaigns_mk">
                <ScalarProperty Name="markmo_id" ColumnName="markmo_id" />
                <ScalarProperty Name="group_id_1" ColumnName="group_id_1" />
                <ScalarProperty Name="group_id_0" ColumnName="group_id_0" />
                <ScalarProperty Name="margin_lavel_3" ColumnName="margin_lavel_3" />
                <ScalarProperty Name="margin_lavel_2" ColumnName="margin_lavel_2" />
                <ScalarProperty Name="margin_lavel_1" ColumnName="margin_lavel_1" />
                <ScalarProperty Name="margin_lavel_0" ColumnName="margin_lavel_0" />
                <ScalarProperty Name="margin_markets" ColumnName="margin_markets" />
                <ScalarProperty Name="type_id" ColumnName="type_id" />
                <ScalarProperty Name="is_run" ColumnName="is_run" />
                <ScalarProperty Name="created" ColumnName="created" />
                <ScalarProperty Name="date_end" ColumnName="date_end" />
                <ScalarProperty Name="date_start" ColumnName="date_start" />
                <ScalarProperty Name="name" ColumnName="name" />
                <ScalarProperty Name="id" ColumnName="id" />
              </MappingFragment>
            </EntityTypeMapping>
          </EntitySetMapping>
          <EntitySetMapping Name="markmo_types">
            <EntityTypeMapping TypeName="LoyaltyModel.markmo_types">
              <MappingFragment StoreEntitySet="markmo_types">
                <ScalarProperty Name="is_card_binding_obligatory" ColumnName="is_card_binding_obligatory" />
                <ScalarProperty Name="title" ColumnName="title" />
                <ScalarProperty Name="markmo_type_id" ColumnName="markmo_type_id" />
              </MappingFragment>
            </EntityTypeMapping>
          </EntitySetMapping>
          <EntitySetMapping Name="markmos1">
            <EntityTypeMapping TypeName="LoyaltyModel.markmos1">
              <MappingFragment StoreEntitySet="markmos1">
                <ScalarProperty Name="max_amount" ColumnName="max_amount" />
                <ScalarProperty Name="distinct_cnt" ColumnName="distinct_cnt" />
                <ScalarProperty Name="web_short_description" ColumnName="web_short_description" />
                <ScalarProperty Name="web_title" ColumnName="web_title" />
                <ScalarProperty Name="by_request" ColumnName="by_request" />
                <ScalarProperty Name="check_min_margin" ColumnName="check_min_margin" />
                <ScalarProperty Name="min_margin" ColumnName="min_margin" />
                <ScalarProperty Name="msg_serv" ColumnName="msg_serv" />
                <ScalarProperty Name="value_max" ColumnName="value_max" />
                <ScalarProperty Name="msg_gift" ColumnName="msg_gift" />
                <ScalarProperty Name="msg_check" ColumnName="msg_check" />
                <ScalarProperty Name="value" ColumnName="value" />
                <ScalarProperty Name="description" ColumnName="description" />
                <ScalarProperty Name="markmo_type_id" ColumnName="markmo_type_id" />
                <ScalarProperty Name="markets" ColumnName="markets" />
                <ScalarProperty Name="market_id" ColumnName="market_id" />
                <ScalarProperty Name="end_date" ColumnName="end_date" />
                <ScalarProperty Name="start_date" ColumnName="start_date" />
                <ScalarProperty Name="markmo_id" ColumnName="markmo_id" />
              </MappingFragment>
            </EntityTypeMapping>
          </EntitySetMapping>
          <EntitySetMapping Name="v_campaigns_mk">
            <EntityTypeMapping TypeName="LoyaltyModel.v_campaigns_mk">
              <MappingFragment StoreEntitySet="v_campaigns_mk">
                <ScalarProperty Name="number" ColumnName="number" />
                <ScalarProperty Name="markmo_id" ColumnName="markmo_id" />
                <ScalarProperty Name="group_id_1" ColumnName="group_id_1" />
                <ScalarProperty Name="group_id_0" ColumnName="group_id_0" />
                <ScalarProperty Name="margin_lavel_3" ColumnName="margin_lavel_3" />
                <ScalarProperty Name="margin_lavel_2" ColumnName="margin_lavel_2" />
                <ScalarProperty Name="margin_lavel_1" ColumnName="margin_lavel_1" />
                <ScalarProperty Name="margin_lavel_0" ColumnName="margin_lavel_0" />
                <ScalarProperty Name="margin_markets" ColumnName="margin_markets" />
                <ScalarProperty Name="type_id" ColumnName="type_id" />
                <ScalarProperty Name="is_run" ColumnName="is_run" />
                <ScalarProperty Name="created" ColumnName="created" />
                <ScalarProperty Name="date_end" ColumnName="date_end" />
                <ScalarProperty Name="date_start" ColumnName="date_start" />
                <ScalarProperty Name="name" ColumnName="name" />
                <ScalarProperty Name="id" ColumnName="id" />
              </MappingFragment>
            </EntityTypeMapping>
          </EntitySetMapping>
          <EntitySetMapping Name="v_campaigns_mk_run">
            <EntityTypeMapping TypeName="LoyaltyModel.v_campaigns_mk_run">
              <MappingFragment StoreEntitySet="v_campaigns_mk_run">
                <ScalarProperty Name="markmo_id" ColumnName="markmo_id" />
                <ScalarProperty Name="group_id_1" ColumnName="group_id_1" />
                <ScalarProperty Name="group_id_0" ColumnName="group_id_0" />
                <ScalarProperty Name="margin_lavel_3" ColumnName="margin_lavel_3" />
                <ScalarProperty Name="margin_lavel_2" ColumnName="margin_lavel_2" />
                <ScalarProperty Name="margin_lavel_1" ColumnName="margin_lavel_1" />
                <ScalarProperty Name="margin_lavel_0" ColumnName="margin_lavel_0" />
                <ScalarProperty Name="margin_markets" ColumnName="margin_markets" />
                <ScalarProperty Name="type_id" ColumnName="type_id" />
                <ScalarProperty Name="is_run" ColumnName="is_run" />
                <ScalarProperty Name="created" ColumnName="created" />
                <ScalarProperty Name="date_end" ColumnName="date_end" />
                <ScalarProperty Name="date_start" ColumnName="date_start" />
                <ScalarProperty Name="name" ColumnName="name" />
                <ScalarProperty Name="id" ColumnName="id" />
              </MappingFragment>
            </EntityTypeMapping>
          </EntitySetMapping>
          <EntitySetMapping Name="v_fgroups">
            <EntityTypeMapping TypeName="LoyaltyModel.v_fgroups">
              <MappingFragment StoreEntitySet="v_fgroups">
                <ScalarProperty Name="vdepartment_id" ColumnName="vdepartment_id" />
                <ScalarProperty Name="is_virtual" ColumnName="is_virtual" />
                <ScalarProperty Name="mt_months" ColumnName="mt_months" />
                <ScalarProperty Name="clear_forbidden" ColumnName="clear_forbidden" />
                <ScalarProperty Name="name_ru" ColumnName="name_ru" />
                <ScalarProperty Name="pperson_id" ColumnName="pperson_id" />
                <ScalarProperty Name="is_unload" ColumnName="is_unload" />
                <ScalarProperty Name="deleted" ColumnName="deleted" />
                <ScalarProperty Name="department_id" ColumnName="department_id" />
                <ScalarProperty Name="author_id" ColumnName="author_id" />
                <ScalarProperty Name="level_id" ColumnName="level_id" />
                <ScalarProperty Name="parent_id" ColumnName="parent_id" />
                <ScalarProperty Name="comments" ColumnName="comments" />
                <ScalarProperty Name="name" ColumnName="name" />
                <ScalarProperty Name="fgroup_id" ColumnName="fgroup_id" />
              </MappingFragment>
            </EntityTypeMapping>
          </EntitySetMapping>
          <EntitySetMapping Name="campaigns_terms">
            <EntityTypeMapping TypeName="LoyaltyModel.campaigns_terms">
              <MappingFragment StoreEntitySet="campaigns_terms">
                <ScalarProperty Name="Rn" ColumnName="Rn" />
                <ScalarProperty Name="description" ColumnName="description" />
                <ScalarProperty Name="short_comment" ColumnName="short_comment" />
                <ScalarProperty Name="created" ColumnName="created" />
                <ScalarProperty Name="campaign_id" ColumnName="campaign_id" />
                <ScalarProperty Name="campaigns_terms_id" ColumnName="campaigns_terms_id" />
              </MappingFragment>
            </EntityTypeMapping>
          </EntitySetMapping>
          <FunctionImportMapping FunctionImportName="t_get_campaigns" FunctionName="Хранилище LoyaltyModel.t_get_campaigns">
            <ResultMapping>
              <ComplexTypeMapping TypeName="LoyaltyModel.tf_campaigns">
                <ScalarProperty Name="id" ColumnName="id" />
                <ScalarProperty Name="name" ColumnName="name" />
                <ScalarProperty Name="date_start" ColumnName="date_start" />
                <ScalarProperty Name="date_end" ColumnName="date_end" />
                <ScalarProperty Name="created" ColumnName="created" />
                <ScalarProperty Name="is_run" ColumnName="is_run" />
                <ScalarProperty Name="type_id" ColumnName="type_id" />
                <ScalarProperty Name="margin_markets" ColumnName="margin_markets" />
                <ScalarProperty Name="margin_lavel_0" ColumnName="margin_lavel_0" />
                <ScalarProperty Name="margin_lavel_1" ColumnName="margin_lavel_1" />
                <ScalarProperty Name="margin_lavel_2" ColumnName="margin_lavel_2" />
                <ScalarProperty Name="margin_lavel_3" ColumnName="margin_lavel_3" />
                <ScalarProperty Name="group_id_0" ColumnName="group_id_0" />
                <ScalarProperty Name="group_id_1" ColumnName="group_id_1" />
                <ScalarProperty Name="markmo_id" ColumnName="markmo_id" />
                <ScalarProperty Name="number" ColumnName="number" />
                <ScalarProperty Name="customers_qty" ColumnName="customers_qty" />
                <ScalarProperty Name="customers_qty_control" ColumnName="customers_qty_control" />
                <ScalarProperty Name="max_term_date" ColumnName="max_term_date" />
              </ComplexTypeMapping>
            </ResultMapping>
          </FunctionImportMapping>
          <EntitySetMapping Name="dict_markets">
            <EntityTypeMapping TypeName="LoyaltyModel.dict_markets">
              <MappingFragment StoreEntitySet="dict_markets">
                <ScalarProperty Name="date_start" ColumnName="date_start" />
                <ScalarProperty Name="is_start" ColumnName="is_start" />
                <ScalarProperty Name="market_name" ColumnName="market_name" />
                <ScalarProperty Name="name" ColumnName="name" />
                <ScalarProperty Name="short_name" ColumnName="short_name" />
                <ScalarProperty Name="id" ColumnName="id" />
              </MappingFragment>
            </EntityTypeMapping>
          </EntitySetMapping>
        </EntityContainerMapping>
      </Mapping>
    </edmx:Mappings>
  </edmx:Runtime>
  <!-- EF Designer content (DO NOT EDIT MANUALLY BELOW HERE) -->
  <Designer xmlns="http://schemas.microsoft.com/ado/2009/11/edmx">
    <Connection>
      <DesignerInfoPropertySet>
        <DesignerProperty Name="MetadataArtifactProcessing" Value="EmbedInOutputAssembly" />
      </DesignerInfoPropertySet>
    </Connection>
    <Options>
      <DesignerInfoPropertySet>
        <DesignerProperty Name="ValidateOnBuild" Value="true" />
        <DesignerProperty Name="EnablePluralization" Value="false" />
        <DesignerProperty Name="IncludeForeignKeysInModel" Value="true" />
        <DesignerProperty Name="UseLegacyProvider" Value="false" />
        <DesignerProperty Name="CodeGenerationStrategy" Value="Нет" />
      </DesignerInfoPropertySet>
    </Options>
    <!-- Diagram content (shape and connector positions) -->
    <Diagrams></Diagrams>
  </Designer>
</edmx:Edmx>